<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>StreamVerse - Canales en Vivo</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(180deg, #0d1b2a, #1b263b, #415a77);
            color: white;
            scroll-behavior: smooth;
            min-height: 100vh;
        }

        /* --- NUEVO: ESTILOS PARA EL POPUP DE MANTENIMIENTO --- */
        #maintenance-overlay {
            position: fixed; /* Cubre toda la pantalla y no se mueve con el scroll */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9); /* Fondo muy oscuro */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Se asegura de estar encima de todo */
        }
        #maintenance-overlay img {
            max-width: 90%; /* La imagen no será más ancha que el 90% de la pantalla */
            max-height: 90vh; /* La imagen no será más alta que el 90% de la altura de la ventana */
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 170, 255, 0.5);
        }
        /* --- FIN DE ESTILOS DEL POPUP --- */

        /* NAVBAR FIX */
        nav {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%;
            box-sizing: border-box;
        }
        nav img {
            height: 40px;
            flex-shrink: 0;
        }
        .nav-links {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            justify-content: flex-end;
            align-items: center;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            font-size: 1rem;
            transition: color 0.3s;
            cursor: pointer;
            padding: 5px 0;
            white-space: nowrap;
        }
        .nav-links a[href="/"] {
            color: #00aaff;
            border-bottom: 2px solid #00aaff;
        }
        .nav-links a:hover {
            color: #00aaff;
        }

        @media (max-width: 768px) {
            .nav-links {
                gap: 15px;
                font-size: 0.9rem;
            }
            .nav-links a:nth-child(n+4) {
                display: none;
            }
        }
        /* Fin de NAVBAR FIX */

        /* Contenedor principal para el reproductor y la lista de canales */
        .main-content-wrapper {
            display: flex;
            max-width: 1600px;
            margin: 30px auto;
            gap: 20px;
            padding: 0 20px;
            flex-direction: column; /* Por defecto, se apilan verticalmente */
        }

        /* En pantallas más grandes (desktop), se colocan uno al lado del otro */
        @media (min-width: 992px) {
            .main-content-wrapper {
                flex-direction: row; /* En desktop, se ponen en fila */
                align-items: flex-start;
            }
        }

        /* Estilos para el reproductor */
        #player-container {
            width: 100%; /* Ocupa todo el ancho disponible */
            height: 250px; /* Altura más manejable en móvil */
            background-color: black;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,170,255,0.7);
            position: relative;
            margin: 0 auto;
        }

        @media (min-width: 992px) {
            #player-container {
                flex-grow: 1; /* Ocupa el espacio restante en desktop */
                height: 600px; /* Altura original para desktop */
                flex-basis: calc(100% - 370px); /* 100% menos el ancho de la sidebar y el gap */
                margin: 0;
            }
        }

        /* Make the video.js player fill its container */
        .video-js {
            width: 100% !important;
            height: 100% !important;
            border-radius: 12px;
        }

        /* Contenedor de la lista de canales (sidebar) */
        .channels-sidebar {
            width: 100%; /* Ocupa todo el ancho en móvil */
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            padding: 15px;
            overflow-y: auto;
            max-height: 500px; /* Limita la altura en móvil para evitar que sea demasiado larga */
        }

        @media (min-width: 992px) {
            .channels-sidebar {
                width: 350px; /* Fija el ancho en desktop */
                min-width: 350px; /* Asegura un ancho mínimo en desktop */
                max-width: 350px; /* Asegura un ancho máximo en desktop */
                height: 600px; /* Fija la altura en desktop para que sea igual que el reproductor */
                max-height: unset; /* Elimina el límite de altura en desktop */
            }
        }

        /* Search Input Field Styling */
        #channelSearch {
            width: calc(100% - 20px); /* Account for padding */
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #00aaff;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 1rem;
            box-sizing: border-box; /* Include padding in the element's total width and height */
        }
        #channelSearch::placeholder {
            color: #bbb;
        }

        .channels-sidebar .canal-box {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            background-color: rgba(0, 0, 0, 0.6);
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 10px;
            box-shadow: none;
            transition: background-color 0.2s ease;
            width: auto; /* Permite que el ancho se ajuste */
        }

        .channels-sidebar .canal-box:hover {
            background-color: rgba(0, 0, 0, 0.8);
            transform: none;
        }

        .channels-sidebar .canal-box img {
            width: 60px;
            height: 40px;
            object-fit: contain;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .channels-sidebar .canal-box h3 {
            margin: 0;
            font-size: 0.9rem;
            flex-grow: 1;
            text-align: left;
        }

        /* ESTILOS DEL BOTÓN REPRODUCIR (NUEVOS O MODIFICADOS) */
        .channels-sidebar .canal-box button {
            padding: 8px 15px;
            font-size: 0.85rem;
            font-weight: bold;
            color: #ffffff;
            background: linear-gradient(90deg, #00aaff, #0077cc);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 170, 255, 0.4);
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-left: 10px;
        }

        .channels-sidebar .canal-box button:hover {
            background: linear-gradient(90deg, #0077cc, #00aaff);
            box-shadow: 0 6px 12px rgba(0, 170, 255, 0.6);
            transform: translateY(-2px);
        }

        .channels-sidebar .canal-box button:active {
            background: #0055aa;
            box-shadow: 0 2px 4px rgba(0, 170, 255, 0.4);
            transform: translateY(0);
        }
        /* FIN ESTILOS DEL BOTÓN REPRODUCIR */

        /* Estilos para el cuadro EPG */
        .epg-info {
            width: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            padding: 5px 8px;
            margin-top: 8px;
            font-size: 0.85rem;
            color: #bbb;
            box-sizing: border-box;
            line-height: 1.3;
        }

        .epg-info p {
            margin: 0;
        }

        .epg-program-title {
            font-weight: bold;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .epg-program-time {
            font-size: 0.75rem;
            color: #999;
        }

        /* Estilos para las secciones desplegables (detalles/summary) */
        .eventos-section {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .eventos-section summary {
            font-size: 1.1rem;
            font-weight: bold;
            color: #00aaff;
            cursor: pointer;
            padding: 10px 15px;
            outline: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 12px;
        }

        .eventos-section summary::-webkit-details-marker {
            display: none;
        }
        .eventos-section summary::after {
            content: '+';
            font-size: 1.5rem;
            transition: transform 0.2s;
        }
        .eventos-section[open] summary::after {
            content: '-';
        }

        .eventos-channels-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 10px 15px 5px;
        }

        .eventos-channels-container .canal-box {
            background-color: rgba(0, 0, 0, 0.7);
            box-shadow: none;
            width: auto;
        }

        /* Ajustes para pantallas pequeñas (ya definidos, pero los revisamos) */
        @media (max-width: 991px) {
            #player-container {
                height: 250px; /* Altura más manejable para el reproductor en móvil */
            }
            .channels-sidebar {
                max-height: 400px; /* Altura de la lista de canales en móvil */
            }
        }

        /* Player Controls */
        #player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            background-color: rgba(0, 0, 0, 0.4);
            padding: 10px;
            border-radius: 12px;
        }

        #player-controls button {
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: bold;
            color: #ffffff;
            background: linear-gradient(90deg, #00aaff, #0077cc);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 170, 255, 0.4);
            transition: all 0.3s ease;
        }

        #player-controls button:hover {
            background: linear-gradient(90deg, #0077cc, #00aaff);
            box-shadow: 0 6px 12px rgba(0, 170, 255, 0.6);
            transform: translateY(-2px);
        }

        #player-controls button:active {
            background: #0055aa;
            box-shadow: 0 2px 4px rgba(0, 170, 255, 0.4);
            transform: translateY(0);
        }
    </style>
</head>
<body>

    <nav>
        <a href="/"><img src="logo.png" alt="Logo"></a>
        <div class="nav-links">
            <a href="/">Inicio</a>
            <a href="/peliculas.html">Zona de Películas</a>
            <a href="/repeticiones.html">Repeticiones</a>
            <a href="https://mediaformulaiptv.vercel.app/f1zone.html">F1</a>
            <a href="/noticias.html">Noticias</a>
            <a href="/tv.html">TV</a>
        </div>
    </nav>

    <div class="main-content-wrapper">
        <div id="player-container">
            <video id="my-video" class="video-js vjs-default-skin" controls preload="auto" data-setup='{}'>
                <source src="" type="application/x-mpegURL">
            </video>
            <div id="player-controls">
                <button onclick="toggleMute()">Toggle Mute</button>
            </div>
        </div>

        <div class="channels-sidebar">
            <div class="eventos-section">
                <summary>Canales en Vivo</summary>
                <div class="eventos-channels-container">
                    <input type="text" id="channelSearch" placeholder="Buscar canal..." onkeyup="filterChannels()">

                    <div class="canal-box" data-channel-id="WKAQDT.pr">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s12468_dark_360w_270h.png" alt="Telemundo PR Logo" />
                        <h3>Telemundo PR</h3>
                        <button onclick="cambiarStream('https://nbculocallive.akamaized.net/hls/live/2037499/puertorico/stream1/master.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="WAPADT.pr">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s63389_dark_360w_270h.png" alt="Wapa TV Logo" />
                        <h3>Wapa TV</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=https://nflarcadia.xyz/bRtT37sn3w/Sx5q6YTgCs/13.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="WAPADT2(English).pr">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s63739_dark_360w_270h.png" alt="Wapa Deportes Logo" />
                        <h3>Wapa Deportes</h3>
                        <button onclick="cambiarStream('https://nflarcadia.xyz/bRtT37sn3w/Sx5q6YTgCs/13.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="WLIIDT.pr">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s43726_dark_360w_270h.png" alt="TeleOnce Logo" />
                        <h3>TeleOnce</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/372002.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="WABC.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s10003_dark_360w_270h.png" alt="ABC 7 Logo" />
                        <h3>ABC 7</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/896411.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="TNT.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s11164_dark_360w_270h.png" alt="TNT Logo" />
                        <h3>TNT</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/939486.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="USANetwork.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s11207_dark_360w_270h.png" alt="USA Network Logo" />
                        <h3>USA Network</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/939487.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="DAZN1(src01).es">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/DAZN_1.svg/1280px-DAZN_1.svg.png" alt="DAZN 1 Logo" />
                        <h3>DAZN 1</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/544810.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="DAZNF1(src01).es">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/7/70/DAZN_F1_logo.png" alt="DAZN F1 Logo" />
                        <h3>DAZN F1</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/544213.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="ESPN.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s10179_dark_360w_270h.png" alt="ESPN (USA) Logo" />
                        <h3>ESPN (USA)</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/840789.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="ESPN2.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s12444_dark_360w_270h.png" alt="ESPN 2 (USA) Logo" />
                        <h3>ESPN 2 (USA)</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/896116.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="ESPNDeportes(Spanish).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s25595_dark_360w_270h.png" alt="ESPN Deportes Logo" />
                        <h3>ESPN Deportes</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/878936.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FoxDeportes(Spanish).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s15377_dark_360w_270h.png" alt="Fox Deportes Logo" />
                        <h3>Fox Deportes</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/878935.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FoxSports2.pr">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/FS2_logo_2015.svg/800px-FS2_logo_2015.svg.png" alt="FS2 Logo" />
                        <h3>FS2</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775027.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FoxSportsPremium(Spanish).mx">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s123582_dark_360w_270h.png" alt="Fox Sports Premium MX Logo" />
                        <h3>Fox Sports Premium MX</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/409436.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="MLBNetwork.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s62081_dark_360w_270h.png" alt="MLB Network Logo" />
                        <h3>MLB Network</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/830401.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="NBATV.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s32281_dark_360w_270h.png" alt="NBA TV Logo" />
                        <h3>NBA TV</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/830392.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="NBCSportsBayArea.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s63138_dark_360w_270h.png" alt="NBC Sports Bay Area Logo" />
                        <h3>NBC Sports Bay Area</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775134.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="NBCSportsBoston.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s49198_dark_360w_270h.png" alt="NBC Sports Boston Logo" />
                        <h3>NBC Sports Boston</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775135.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="NBCSportsCalifornia.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s44917_dark_360w_270h.png" alt="NBC Sports California Logo" />
                        <h3>NBC Sports California</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775136.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="nbcsports-chicago.us">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bd/NBC_Sports_Chicago_2023.svg/960px-NBC_Sports_Chicago_2023.svg.png" alt="NBC Sports Chicago Logo" />
                        <h3>NBC Sports Chicago</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775077.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="nbcsports-philadelphia.us">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/NBC_Sports_Philadelphia_2023.svg/330px-NBC_Sports_Philadelphia_2023.svg.png" alt="NBC Sports Philadelphia Logo" />
                        <h3>NBC Sports Philadelphia</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775079.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="nbcsports-washington.us">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/f/fb/NBC_Sports_Washington.png" alt="NBC Sports Washington Logo" />
                        <h3>NBC Sports Washington</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/775080.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="WWECHANNEL(src04).za">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/03/WWE_Logo.svg/640px-WWE_Logo.svg.png" alt="WWE Network Logo" />
                        <h3>WWE Network</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://cord-cutter.net:8080/25464931/30585186/11645')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="YesNetwork.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s30017_dark_360w_270h.png" alt="YES Network Logo" />
                        <h3>YES Network</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/864765.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetworkDetroit.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s54286_dark_360w_270h.png" alt="Fanduel Sports Network Detroit Logo" />
                        <h3>Fanduel Sports Network Detroit</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940360.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetworkFlorida.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s50728_dark_360w_270h.png" alt="Fanduel Sports Network Florida Logo" />
                        <h3>Fanduel Sports Network Florida</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/896095.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetworkNorthOutofMarket.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s10977_dark_360w_270h.png" alt="Fanduel Sports Network North Logo" />
                        <h3>Fanduel Sports Network North</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940362.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetworkSoCal.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s59625_dark_360w_270h.png" alt="Fanduel Sports Network SoCal Logo" />
                        <h3>Fanduel Sports Network SoCal</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940357.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetwork(South).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s12410_dark_360w_270h.png" alt="Fanduel Sports Network South Logo" />
                        <h3>Fanduel Sports Network South</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940374.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetwork(Southeast).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s61138_dark_360w_270h.png" alt="Fanduel Sports Network Southeast Logo" />
                        <h3>Fanduel Sports Network Southeast</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940376.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetwork(Southwest).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s10262_dark_360w_270h.png" alt="Fanduel Sports Network Southwest Logo" />
                        <h3>Fanduel Sports Network Southwest</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940364.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetworkSunOutofMarket.us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s61084_dark_360w_270h.png" alt="Fanduel Sports Network Sun Logo" />
                        <h3>Fanduel Sports Network Sun</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/940365.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="FanDuelSportsNetwork(West).us">
                        <img src="http://schedulesdirect-api20141201-logos.s3.dualstack.us-east-1.amazonaws.com/stationLogos/s59627_dark_360w_270h.png" alt="Fanduel Sports Network West Logo" />
                        <h3>Fanduel Sports Network West</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/5951991351780py/090325play/940377.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>
                </div>
            </div>

            <details class="eventos-section">
                <summary>Disney+ Eventos</summary>
                <div class="eventos-channels-container">
                    <div class="canal-box" data-channel-id="disneyplus1.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 1 Logo" />
                        <h3>Disney+ 1</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/662325.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus2.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 2 Logo" />
                        <h3>Disney+ 2</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/662327.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus3.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 3 Logo" />
                        <h3>Disney+ 3</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/662328.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus4.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 4 Logo" />
                        <h3>Disney+ 4</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/662342.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus5.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 5 Logo" />
                        <h3>Disney+ 5</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/699786.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus6.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 6 Logo" />
                        <h3>Disney+ 6</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/874816.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus7.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 7 Logo" />
                        <h3>Disney+ 7</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/874817.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus8.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 8 Logo" />
                        <h3>Disney+ 8</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/874818.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="disneyplus9.us">
                        <img src="https://cdn.vox-cdn.com/thumbor/yDcDkg5256nShkwb7J5ZelaLf2k=/0x0:1920x1080/1400x1050/filters:focal(960x540:961x541)/cdn.vox-cdn.com/uploads/chorus_asset/file/25357066/Disney__Logo_March_2024.png" alt="Disney+ 9 Logo" />
                        <h3>Disney+ 9</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/874819.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>
                </div>
            </details>

            <details class="eventos-section">
                <summary>Netflix Eventos</summary>
                <div class="eventos-channels-container">
                    <div class="canal-box" data-channel-id="netflix-eventos1.us">
                        <img src="https://images.icon-icons.com/2699/PNG/512/netflix_logo_icon_170919.png" alt="NetFlix Eventos 1 Logo" />
                        <h3>NetFlix Eventos 1</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=https://giatv.bozztv.com/giatv/giatv-PPVDeportes2/PPVDeportes2/playlist.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="netflix-eventos2.us">
                        <img src="https://images.icon-icons.com/2699/PNG/512/netflix_logo_icon_170919.png" alt="NetFlix Eventos 2 Logo" />
                        <h3>NetFlix Eventos 2</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/960232.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>

                    <div class="canal-box" data-channel-id="netflix-eventos3.us">
                        <img src="https://images.icon-icons.com/2699/PNG/512/netflix_logo_icon_170919.png" alt="NetFlix Eventos 3 Logo" />
                        <h3>NetFlix Eventos 3</h3>
                        <button onclick="cambiarStream('https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://playtvpremium.xyz:8080/live/595991351780py/090325play/960233.m3u8')">Reproducir</button>
                        <div class="epg-info">
                            <p class="epg-program-title">Cargando programación...</p>
                            <p class="epg-program-time"></p>
                        </div>
                    </div>
                </div>
            </details>
        </div>
    </div>

    <div id="maintenance-overlay">
        <img src="mantenimiento_tv.jpg" alt="Sitio en Mantenimiento">
    </div>

    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@videojs/http-streaming@3.9.0/dist/videojs-http-streaming.min.js"></script>

    <script>
        let player = videojs('my-video');

        // Función para cambiar el stream
        function cambiarStream(url) {
            player.src({
                src: url,
                type: 'application/x-mpegURL'
            });
            player.play();
        }

        // Llama a la función para cambiar el stream al cargar la página
        document.addEventListener('DOMContentLoaded', () => {
            cambiarStream('https://nbculocallive.akamaized.net/hls/live/2037499/puertorico/stream1/master.m3u8');
        });

        // Function to filter channels based on search input
        function filterChannels() {
            const input = document.getElementById('channelSearch');
            const filter = input.value.toUpperCase();
            // Select all canal-box elements within all .eventos-channels-container sections
            const channelContainers = document.querySelectorAll('.eventos-channels-container');

            channelContainers.forEach(container => {
                const channelBoxes = container.querySelectorAll('.canal-box');
                channelBoxes.forEach(box => {
                    const channelNameElement = box.querySelector('h3');
                    if (channelNameElement) {
                        const channelName = channelNameElement.textContent.toUpperCase();
                        // Use 'flex' for visibility because these boxes use flexbox
                        if (channelName.includes(filter)) { // Using includes for broader matching
                            box.style.display = "flex";
                        } else {
                            box.style.display = "none";
                        }
                    }
                });
            });
        }

        // Basic Custom Control (Toggle Mute)
        function toggleMute() {
            if (player) {
                player.muted(!player.muted()); // Toggles mute state
                // Optional: Change button text based on mute state
                const muteButton = document.querySelector('#player-controls button');
                if (muteButton) {
                    muteButton.textContent = player.muted() ? 'Unmute' : 'Mute';
                }
            }
        }

        // --- FUNCIONALIDAD EPG ---

        let epgData = null;
        // URL de tu archivo EPG
        const EPG_URL = 'https://iptv-proxystreamverse.fraelvillegasplay9.workers.dev/?url=http://m3u4u.com/xml/j67zn6r9xzcq5k8wnd1w';

        async function fetchAndParseEPG() {
            try {
                console.log("Cargando EPG desde:", EPG_URL);
                const response = await fetch(EPG_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const xmlText = await response.text();
                const parser = new DOMParser();
                epgData = parser.parseFromString(xmlText, "application/xml");
                console.log("EPG cargado y parseado con éxito.");

                // Si el XML no se parseó correctamente, el error se captura aquí
                if (epgData.querySelector('parsererror')) {
                    console.error("Error al parsear el XML del EPG:", epgData.querySelector('parsererror').textContent);
                    throw new Error("XML del EPG mal formado.");
                }

                updateAllChannelEPG(); // Una vez cargado, actualiza todos los canales
            } catch (error) {
                console.error("Error al cargar o parsear el EPG:", error);
                // Mostrar un mensaje de error en la UI para el usuario
                document.querySelectorAll('.epg-program-title').forEach(el => {
                    el.textContent = 'Error EPG';
                    el.nextElementSibling.textContent = 'Intente de nuevo más tarde.';
                });
            }
        }

        // Función para parsear el formato de tiempo XMLTV (YYYYMMDDHHmmss [±HHMM])
        // Esto es crucial y puede ser delicado. Se asume que el offset de zona horaria
        // del EPG es el que se quiere usar, o que es UTC.
        function parseXmlTvTime(timeStr) {
            // Eliminar cualquier signo de zona horaria al final para crear una fecha ISO compatible para Date
            const cleanedTimeStr = timeStr.replace(/(\+\d{4}|\-\d{4}|Z)$/, ''); // Remueve +HHMM o Z

            const year = parseInt(cleanedTimeStr.substring(0, 4), 10);
            const month = parseInt(cleanedTimeStr.substring(4, 6), 10) - 1; // Meses son 0-index en JavaScript
            const day = parseInt(cleanedTimeStr.substring(6, 8), 10);
            const hour = parseInt(cleanedTimeStr.substring(8, 10), 10);
            const minute = parseInt(cleanedTimeStr.substring(10, 12), 10);
            const second = parseInt(cleanedTimeStr.substring(12, 14), 10);

            // Intentar crear la fecha. Asumir UTC si no se puede inferir la zona horaria del string.
            const date = new Date(Date.UTC(year, month, day, hour, minute, second));

            // Si el string original contenía un offset (ej. +0400), ajustarlo.
            // Esto es una simplificación; un manejo completo requeriría más lógica
            // o una librería de fechas.
            const offsetMatch = timeStr.match(/(\+\d{4}|\-\d{4})$/);
            if (offsetMatch) {
                const offsetSign = offsetMatch[0][0];
                const offsetHours = parseInt(offsetMatch[0].substring(1, 3), 10);
                const offsetMinutes = parseInt(offsetMatch[0].substring(3, 5), 10);
                const offsetMilliseconds = (offsetHours * 60 + offsetMinutes) * 60 * 1000;

                if (offsetSign === '+') {
                    date.setTime(date.getTime() - offsetMilliseconds);
                } else if (offsetSign === '-') {
                    date.setTime(date.getTime() + offsetMilliseconds);
                }
            }

            return date.getTime(); // Retorna el timestamp en milisegundos UTC
        }

        function getProgramForChannel(channelId) {
            if (!epgData) return { title: 'No hay datos EPG', time: '' };

            const programs = epgData.querySelectorAll('programme');
            const now = Date.now(); // Tiempo actual en milisegundos

            for (let i = 0; i < programs.length; i++) {
                const program = programs[i];
                const progChannel = program.getAttribute('channel');

                if (progChannel === channelId) {
                    const startStr = program.getAttribute('start');
                    const stopStr = program.getAttribute('stop');

                    const startTime = parseXmlTvTime(startStr);
                    const endTime = parseXmlTvTime(stopStr);

                    if (now >= startTime && now < endTime) {
                        // Encontrado el programa actual
                        const titleElement = program.querySelector('title');
                        const title = titleElement ? titleElement.textContent : 'Título no disponible';

                        const formatTime = (timestamp) => {
                            const date = new Date(timestamp);
                            let hours = date.getHours();
                            const minutes = date.getMinutes().toString().padStart(2, '0');
                            const ampm = hours >= 12 ? 'PM' : 'AM';
                            hours = hours % 12;
                            hours = hours ? hours : 12; // La hora '0' (medianoche) debe ser '12 AM'
                            return `${hours}:${minutes} ${ampm}`;
                        };

                        return {
                            title: title,
                            time: `${formatTime(startTime)} - ${formatTime(endTime)}`
                        };
                    }
                }
            }
            return { title: 'Programación no disponible', time: '' };
        }

        function updateAllChannelEPG() {
            const channelBoxes = document.querySelectorAll('.channels-sidebar .canal-box');
            channelBoxes.forEach(box => {
                const channelId = box.dataset.channelId; // Obtiene el ID del canal del data-attribute
                if (channelId) {
                    const program = getProgramForChannel(channelId);
                    const titleElement = box.querySelector('.epg-program-title');
                    const timeElement = box.querySelector('.epg-program-time');

                    if (titleElement && timeElement) {
                        titleElement.textContent = program.title;
                        timeElement.textContent = program.time;
                    }
                } else {
                    console.warn("Canal-box sin data-channel-id:", box);
                    const titleElement = box.querySelector('.epg-program-title');
                    const timeElement = box.querySelector('.epg-program-time');
                    if (titleElement) titleElement.textContent = 'ID de canal no definido';
                    if (timeElement) timeElement.textContent = '';
                }
            });
        }

        // Llama a la función para cargar el EPG cuando la página esté lista
        document.addEventListener('DOMContentLoaded', () => {
            fetchAndParseEPG(); // Carga el EPG al inicio
            // Actualiza el EPG cada 5 minutos (300000 milisegundos)
            setInterval(updateAllChannelEPG, 300000);
        });
    </script>

</body>
</html>
